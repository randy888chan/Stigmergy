# Stigmergy System State Schema

This document defines the official schema for the `.ai/state.json` file. This file is the **sacred ledger** of the swarm's activity and the sole source of truth for project state. All agents MUST read from and write to this file in accordance with this schema.

## Root Object

- **`schema_version`** (String): The version of this schema. e.g., "3.0".
- **`project_name`** (String): The user-defined name of the project.
- **`goal`** (String): The initial high-level goal provided by the user.
- **`project_status`** (Enum): The current high-level status of the project.
  - `NEEDS_BRIEFING`: Awaiting creation of `docs/brief.md`.
  - `NEEDS_PRD`: Awaiting creation of `docs/prd.md`.
  - `NEEDS_ARCHITECTURE`: Awaiting creation of `docs/architecture.md`.
  - `NEEDS_BLUEPRINT`: Awaiting creation of `execution-blueprint.yml`.
  - `READY_FOR_EXECUTION`: Blueprint is complete, swarm can begin building.
  - `EXECUTION_IN_PROGRESS`: Actively working on blueprint tasks.
  - `EXECUTION_HALTED`: A critical, unrecoverable error occurred.
  - `PROJECT_COMPLETE`: All manifest tasks are complete.
- **`project_manifest`** (Object): The master plan derived from the blueprint.
  - **`tasks`** (Array of Objects): A list of all project tasks.
    - `id` (String): A unique ID for the task, e.g., "T01".
    - `summary` (String): The summary of the task.
    - `agent` (String): The agent alias responsible for the task (e.g., "james").
    - `status` (Enum: "PENDING" | "IN_PROGRESS" | "COMPLETED" | "FAILED").
    - `dependencies` (Array of Strings): A list of task IDs that must be completed first.
    - `failure_count` (Number): **NEW:** Tracks the number of consecutive failures for this task.
- **`history`** (Array of Objects): The **immutable ledger** of all system actions. This is append-only.
  - `timestamp` (String): ISO 8601 timestamp.
  - `agent_id` (String): The ID of the acting agent (e.g., "saul", "james").
  - `signal` (String): The signal generated by the agent's action.
  - `summary` (String): A human-readable summary of the action taken.
- **`issue_log`** (Array of Objects): A log of persistent failures requiring a Responder.
  - `issue_id` (String): A unique ID for the issue.
  - `task_id_ref` (String): The ID of the task that failed.
  - `timestamp` (String): ISO 8601 timestamp when the issue was logged.
  - `status` (Enum: "OPEN" | "IN_PROGRESS" | "RESOLVED" | "FAILED_TO_RESOLVE").
  - `summary` (String): A description of the failure.
